<title>我的待办</title>
<style>
    #nav span, .right span {
        display: none;
    }

    #nav a {
        display: inline-block;
        width: 40px;
        height: 56px;
        text-align: center;
        border: 1px solid #f5f5f5;
    }

    #nav a:nth-of-type(3) {
        display: inline-block;
        width: 220px;
        height: 52px;
        text-align: left;
        padding-left: 20px;
        border-top: 2px solid #000;
        font-weight: bold;
    }

    .right {
        display: inline-block;
        position: absolute;
        top: 0;
        right: 0;
    }

    .layui-breadcrumb a {
        color: #000 !important;
    }

    #title li {
        margin-left: 20px;
        margin-bottom: 5px;
    }

    .select {
        border-bottom: 4px solid #379ff7;
        color: #379ff7 !important;
    }

    .unselect {
        border-bottom: 0;
        color: #000 !important;
    }

    .layui-tab-title .layui-this:after {
        border: 0;
    }

    .options_files {
        width: 102px;
        height: 75px;
        border: 1px solid #000;
        position: absolute;
        right: 440px;
        bottom: 195px;
        display: none
    }

    .options_files li {
        width: 100px;
        height: 25px;
        text-align: center;
        line-height: 25px;
    }

    .create .layui-collapse {
        width: 500px;
        margin-top: 20px;
    }

    .date {
        background: url(./img/datePicker.gif) no-repeat right;
    }

    #select li {
        margin-right: 5px;
        width: auto;
        font-size: 12px;
        padding: 0
    }

    #bottom:hover {
        color: #fff;
        background: #379ff7;
    }

    .role {
        width: 260px;
        height: 272px;
    }

    .role li {
        color: #126DBA;
        padding: 5px 10px !important;
    }

    .role li:hover {
        color: #fff;
        background: #379ff7;
    }

    .list li {
        height: 30px;
        text-align: center;
        line-height: 30px;
    }

    .list li:hover {
        color: #fff;
        background: #379ff7;
    }

    .layui-colla-icon {
        position: absolute;
        top: 0;
    }

    .layui-colla-title {
        background: #fff;
    }

    .layui-colla-item {
        border: none !important;
    }

    #check .layui-form-checkbox[lay-skin=primary] {
        margin-top: -2px;
        margin-left: 10px;
    }

    .node_name {
        color: #000;
    }

    .ztree li span.button.noline_open {
        background-position: -110px -88px;
    }

    .ztree li span.button.ico_docu {
        margin-top: 3px;
    }

    .layui-collapse {
        margin-left: 15px;
    }
</style>

<div class="layui-fluid">
    <div class="layui-card">
        <div class="layui-card-body" style="height: 800px;">
            <div class="layui-tab" id="content">
                <ul class="layui-tab-title" style="height: 44px;" id='title'>
                    <li class=" layui-this select" onclick="getWork()">我的待办</li>
                    <li class="unselect" onclick="historyWork()">我已办结</li>
                    <li class="unselect">我的关注</li>
                    <li class="unselect">挂起工作</li>
                </ul>
                <div class="layui-tab-content">
                    <div class="layui-tab-item layui-show">
                        <form class="layui-form" style="display: inline-block;">
                            <div class="layui-form-item">
                                <label class='layui-form-label' style="width: 60px;">所属流程</label>
                                <div class="layui-input-block" style="margin-left: 90px;">
                                    <input type="text" class="layui-input" style="width: 152px;" data-method="select">
                                </div>
                            </div>
                        </form>
                        <div class="layui-btn-container" style="display: inline-block;margin-left:725px;">
                            <button class="layui-btn " id="create">新建流程</button>
                            <button class="layui-btn ">导出Excel</button>
                            <button class="layui-btn " data-method="move">工作移交</button>
                            <button class="layui-btn " data-method="trust">工作委托</button>
                            <button class="layui-btn " data-method="observe">工作监控</button>
                        </div>
                        <table class="layui-hide" id="workTable" lay-filter="workTable"></table>
                        <ul class="options_files">
                            <li>预览</li>
                            <li>下载</li>
                            <li>转存</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="create" style="display: none;" id="createView">
                <div class="layui-collapse" lay-filter="test" style='display:inline-block'>
                    <div class="layui-colla-item">
                        <h2 class="layui-colla-title">人事类</h2>
                        <div class="layui-colla-content layui-show" id="deployList">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/html" id='deployListTpl'>
    {{# layui.each(d, function(index, item){ }}
    <p onclick="showCreateTaskView('{{item.id}}')">{{item.name}}</p>
    {{# }) }}
</script>
<script type="text/html" id='createTaskViewTpl'>
    <form class="layui-form">
        {{# layui.each(d.data, function(index, item){ }}
        <div class='layui-form-item'>
            <label class='layui-form-label'>{{item.name}}：</label>
            <div class='layui-input-block'>
                <input class="layui-input" placeholder="{{typeof(item.placeholder)=='string'?item.placeholder:''}}" name="{{item.id}}">
            </div>
        </div>
        {{# }) }}
        <input type="hidden" name="id" value="{{d.id}}">
        <div class="button-bar">
            <button class="layui-btn" lay-submit lay-filter="createTask">确认</button>
            <button class="layui-btn" type="button" data-type="close">取消</button>
        </div>
    </form>
</script>
<script type="text/html" id='WorkDetailTpl'>
    <colgroup>
        <col width="50">
        <col width="150">
        <col>
    </colgroup>
    <tbody>
    <tr>
        <td>水表Id：</td>
        <td>{{d.waterMeterId?d.waterMeterId:""}}</td>
    </tr>
    <tr>
        <td>抄表负责人：</td>
        <td>{{d.charger?d.charger:""}}</td>
    </tr>
    <tr>
        <td>抄表方式：</td>
        <td>{{d.checkType?d.checkType:""}}</td>
    </tr>
    <tr>
        <td>计划抄表日期</td>
        <td>{{d.planDate?d.planDate:""}}</td>
    </tr>
    <tr>
        <td>实际抄表时间</td>
        <td>{{d.checkDate?d.checkDate:""}}</td>
    </tr>
    <tr>
        <td>当前状态</td>
        <td>{{d.status?d.status:""}}</td>
    </tr>
    <tr>
        <td>抄表结果</td>
        <td>{{d.watchReading?d.watchReading:""}}</td>
    </tr>
    <tr>
        <td>当前水表读数</td>
        <td>{{d.watchReading?d.watchReading:""}}</td>
    </tr>
    <tr>
        <td>本阶段实际用水量</td>
        <td>{{d.stepConsumption?d.stepConsumption:""}}</td>
    </tr>
    <tr>
        <td>本阶段水费</td>
        <td>{{d.waterAmount?d.waterAmount:""}}</td>
    </tr>
    </tbody>
</script>
<script type="text/html" id='doWorkTpl'>
    <form class="layui-form">
        {{# layui.each(d.data, function(index, item){ }}
        <div class='layui-form-item'>
            <label class='layui-form-label'>{{item.name}}：</label>
            <div class='layui-input-block'>
                <input class="layui-input" placeholder="{{typeof(item.placeholder)=='string'?item.placeholder:''}}" name="{{item.id}}">
            </div>
        </div>
        {{# }) }}
        <input type="hidden" name="id" value="{{d.id}}">
        <div class="button-bar">
            <button class="layui-btn" lay-submit lay-filter="finishTask">提交</button>
        </div>
    </form>
</script>
<script type="text/html" id="workNameTpl">
    <div>
        <a href="javascript:showWorkDetail();" style='color:#126DBA'>{{d.name}}</a>
    </div>
</script>
<script type="text/html" id="belong">
    <div>
        <a href="#" style='color:#126DBA'>{{d.pName}}</a>
    </div>
</script>
<script type="text/html" id="step">
    <div>
        <a href="javascript:showImg('{{d.processInstanceId}}')" style='color:#126DBA'>{{d.name}}</a>
    </div>
</script>
<script type="text/html" id="createUserTpl">
    lidonghui
</script>
<script type="text/html" id="operation">
    <div class='layui-btn-container'>
        {{# if(d.state == 0){
        if(d.assignee){ }}
        <button class='layui-btn  layui-btn-sm' lay-event='doWork'>主办</button>
        <!--<button class='layui-btn  layui-btn-sm' lay-event='trusted'>委托</button>-->
        {{# }else{ }}
        <button class='layui-btn  layui-btn-sm' lay-event='takeWork'>认领</button>
        {{# }
        }
        }}
        <!--<button class='layui-btn  layui-btn-sm'>导出</button>-->
        <!--<button class='layui-btn  layui-btn-sm' lay-event='delete'>删除</button>-->
    </div>
</script>
<script type="text/html" id="userListTpl">
    {{# layui.each(d,function(index,item){ }}
    <div class="layui-form-item" data_id="{{item.id}}" data_name="{{item.id}}" pane="">
        <div class="layui-input-block">
            <p>{{item.group}}：{{item.id}}（{{item.lastName}}{{item.firstName}}）</p>
        </div>
    </div>
    {{# }) }}
</script>

<script>
    var modelObj = {};
    var workType = 0;
    var currUser = $("#currUser").text();
    getWork();
    function getWork(){
        showWork();
        ajax("/flowable/taskList","get",{userName:currUser}).then(res => {
            console.log(res);
            layui.table.render({
                elem: '#workTable'
                ,data:res.obj
                ,limit:15
                ,cols: [[
                    {type:'checkbox'}
                    ,{field:'id', title: '流水号'}
                    ,{field:'name', title: '工作名称'/*,templet:"#workNameTpl"*/}
                    ,{field:'pName',title: '所属流程'}
                    ,{field:'createUser', title: '发起人'}
                    ,{field:'name', title: '步骤与流程图', templet:"#step"}
                    ,{field:'time', title: '接收时间'}
                    ,{field:'state', title: '状态', templet:"#stateTpl"}
                    ,{field:'operations',  title: '操作',toolbar:"#operation"}
                ]]
            });
        });
    }
    function historyWork(){
        ajax("/flowable/historyList","get",{userName:currUser}).then(res => {
            layui.table.render({
                elem: '#workTable'
                ,data:res.obj
                ,limit:15
                ,cols: [[
                    {type:'checkbox'}
                    ,{field:'id', width:290, title: '流水号'}
                    ,{field:'name', minWidth:150, title: '工作名称'/*,templet:"#workNameTpl"*/}
                    ,{field:'pName', width:120, title: '所属流程'}
                    ,{field:'createUser', width:100, title: '发起人'}
                    ,{field:'name', title: '步骤与流程图', minWidth: 100,templet:"#step"}
                    ,{field:'time', width:160, title: '结束时间'}
                    ,{field:'state', width:80, title: '状态', templet:"#stateTpl"}
                ]]
            });
        });
    }
    function showCreateTaskView(id) {
        ajax("/flowable/startForm","get",{id:id}).then(res => {
            if(res.obj.fields){
                layer.open({
                    type: 1 //此处以iframe举例
                    ,title: '创建流程'
                    ,area: ['400px', '348px']
                    ,maxmin: false
                    ,content: "<div id='createTaskView'></div>"
                });
                layui.laytpl($("#createTaskViewTpl").html()).render({id:id,data:res.obj.fields}, function(html){
                    $("#createTaskView").html(html);
                })
            }else{
                createTask(id);
            }
            showWork();
        })
    }
    function showWorkDetail(){
        layer.open({
            type: 1 //此处以iframe举例
            ,title: '详情'
            ,area: ['400px', '560px']
            ,maxmin: false
            ,content: "<div class='layui-card-body'><table class='layui-table' lay-even='' lay-skin='row' id='detailView'></table></div>"
        });
        layui.laytpl($("#WorkDetailTpl").html()).render({}, function(html){
            $("#detailView").html(html);
        })
    }
    function showImg(processId){
        layer.open({
            type: 1 //此处以iframe举例
            ,title: '流程进度图'
            ,area: ['1390px', '590px']
            ,maxmin: false
            ,content: "<div class='layui-card-body'><img src='/flowable/getImg?id="+processId+"'/></div>"
        });
    }

    function showWork(){
        $("#content").addClass("layui-show");
        $("#content").show();
        $('#createView').hide();
    }
    function createTask(id){
        var param = {processDefinitionId:id};
        var variables = [];
        variables.push({name:"checkWaterMeterPlan_id",value:"1001"});
        variables.push({name:"checker",value:"zhangsan"});
        variables.push({name:"checker_type",value:0});
        param.variables = variables;
        ajax2("/flowable/start","post",{data:JSON.stringify(param)}).then(function (res) {
            if(res.success){
                layer.closeAll();
            }else{
                layer.alert(res.msg);
            }
        })
    }
</script>
<script>
    $(function(){
        $("#create").click(function(){
            ajax("/flowable/process","post",{}).then(res => {
                layui.laytpl($("#deployListTpl").html()).render(res.obj, function(html){
                    $("#deployList").html(html);
                    $("#content").hide();
                    $("#content").removeClass("layui-show");
                    layui.use(['element', 'layer'], function(){
                        var element = layui.element;
                        var layer = layui.layer;
                        element.render('collapse');
                    });
                    $('#createView').show();
                })
            })
        })
        $("#content li").on('click', function (e) {
            var others = $(this).siblings();
            if ($(this).hasClass('unselect')) {
                $(this).removeClass('unselect');
                $(this).addClass('select');
                others.addClass('unselect');
                $('#createView').hide();
            }
            workType = $(this).index();
        })
    })
</script>
<script>
    layui.form.on('submit(createTask)', function(data){
        var fields = data.field;
        var parm = {};
        var variables = [];
        for(var key in fields){
            if(key == "id"){
                parm.processDefinitionId = fields.id;
            }else{
                variables.push({name:key,value:fields[key]});
            }
        }
        parm.variables = variables;
        ajax2("/flowable/start","post",{data:JSON.stringify(parm)}).then(function (res) {
            if(res.success){
                layer.closeAll();
            }else{
                layer.alert(res.msg);
            }
        })
        return false;
    });
    layui.table.on('tool(workTable)', function(obj){
        var data = obj.data;
        if(obj.event === 'del'){
            layer.confirm('真的删除行么', function(index){
                layer.close(index);
            });
        } else if(obj.event === 'doWork'){
            if(data.name == '册页录入'){
                var params = {};
                finishWork(data.id,params);
            }else if(data.name == '抄表器抄表'){
                var params = {};
                finishWork(data.id,params);
            }else if(data.name == '远抄'){
                var params = {};
                finishWork(data.id,params);
            }else if(data.name == '核册'){
                layer.confirm("有无异常",{
                        btn: ['有', '无'] //只是为了演示
                    },function(){
                        var params = {};
                        var variables = [{name:"hasCheckException",value:true}];
                        params.variables = variables
                        finishWork(data.id,params);
                        layer.closeAll();
                    }
                    ,function(){
                        var params = {};
                        var variables = [{name:"hasCheckException",value:false}];
                        params.variables = variables
                        finishWork(data.id,params);
                        layer.closeAll();
                    });
            }else if(data.name == '确定是否需要复查'){
                layer.confirm("确定是否需要复查",{
                        btn: ['是', '否'] //只是为了演示
                    },function(){
                        var params = {};
                        var variables = [{name:"needRecheck",value:true}];
                        params.variables = variables
                        finishWork(data.id,params);
                        layer.closeAll();
                    }
                    ,function(){
                        var params = {};
                        var variables = [{name:"needRecheck",value:false}];
                        params.variables = variables
                        finishWork(data.id,params);
                        layer.closeAll();
                    });
            }else if(data.name == '按权限审批'){
                var params = {};
                finishWork(data.id,params);
            }else if(data.name == '计算'){
                var params = {};
                finishWork(data.id,params);
            }else if(data.name == '水量水费复查'){
                layer.confirm("确定是否有问题",{
                        btn: ['是', '否'] //只是为了演示
                    },function(){
                        var params = {};
                        var variables = [{name:"hasException",value:true}];
                        params.variables = variables
                        finishWork(data.id,params);
                        layer.closeAll();
                    }
                    ,function(){
                        var params = {};
                        var variables = [{name:"hasException",value:false}];
                        params.variables = variables
                        finishWork(data.id,params);
                        layer.closeAll();
                    });
            }else if(data.name == '发单'){
                var params = {};
                finishWork(data.id,params);
            }
        } else if(obj.event === 'takeWork'){
            var params = {assignee:currUser};
            ajax2("/flowable/takeWork","post",{id:data.id,body:JSON.stringify(params)}).then(res=>{
                getWork();
            })
        }
    });
    function finishWork(id,params){
        params.action = "complete";
        ajax2("/flowable/completeTask","post",{id:id,body:JSON.stringify(params)}).then(res => {
            if(res.success){
                getWork();
            }else{
                layer.alert(res.msg);
            }
        });
    }
</script>
<script>
    layui.use('layer', function () {
        var layer = layui.layer;
        var active = {

            select: function () {
                var that = this;
                layer.open({
                    type: 1 //此处以iframe举例
                    , title: '选择流程'
                    , area: ['400px', '348px']
                    , shade: 0.3
                    , maxmin: false
                    , id: "_add"
                    , content: "<div id='form4'></div>"
                });
                layui.laytpl($("#select1").html()).render({}, function (html) {
                    $("#form4").html(html);
                    layui.form.render();
                })

                var settingss = {
                    data: {
                        simpleData: {
                            enable: true, //true 、 false 分别表示 使用 、 不使用 简单数据模式
                            idKey: "id", //节点数据中保存唯一标识的属性名称
                            pIdKey: "parentId", //节点数据中保存其父节点唯一标识的属性名称
                            rootPId: -1 //用于修正根节点父节点数据，即 pIdKey 指定的属性值
                        },
                        key: {
                            name: "menuName" //zTree 节点数据保存节点名称的属性名称  默认值："name"
                        }
                    },
                    view: {
                        showLine: false,
                        showPlusMinus: false,
                        showIcon: true,
                        dblClickExpand: false,
                        fontCss: {
                            'color': 'white',
                            'font-weight': 'normal'
                        }
                    }
                };

                //数据
                var zNodes = [
                    //注意，数据中的 menuName 必须与 settingss 中key 中定义的name一致，否则找不到
                    {
                        menuName: "全部流程",
                        icon: "./img/wf_node2.png",
                    },
                    {
                        menuName: "默认分类",
                        icon: "./img/wf_node1.png",
                        open: true,
                        children: [
                            {
                                menuName: "签章测试流程",
                                icon: "./img/wf_node2.png"
                            },
                            {
                                menuName: "测试111",
                                icon: "./img/wf_node2.png"
                            },
                        ]
                    },
                    {
                        menuName: "人事类",
                        icon: "./img/wf_node1.png",
                        open: true,
                        children: [
                            {
                                menuName: "员工外出申请（业务）",
                                icon: "./img/wf_node2.png"
                            }
                        ]
                    },
                    {
                        menuName: "费用类",
                        icon: "./img/wf_node1.png",
                        open: true,
                        children: [
                            {
                                menuName: "个人年度费用计划申请（业务）",
                                icon: "./img/wf_node2.png"
                            }
                        ]
                    },
                    {
                        menuName: "合同类",
                        icon: "./img/wf_node1.png",
                        open: true,
                        children: [
                            {
                                menuName: "合同审批申请（演示）",
                                icon: "./img/wf_node2.png"
                            }
                        ]
                    },
                    {
                        menuName: "公文类",
                        icon: "./img/wf_node1.png",
                        open: true,
                        children: [
                            {
                                menuName: "办公室发文",
                                icon: "./img/wf_node2.png"
                            },
                            {
                                menuName: "办公室收文",
                                icon: "./img/wf_node2.png"
                            }
                        ]
                    }
                ];

                zTreeObj = $.fn.zTree.init($("#treeDemo"), settingss, zNodes); //初始化树
                zTreeObj.expandAll(true);

            }
        }
        $('.layui-input').focus(function () {
            var othis = $(this), method = othis.data('method');
            active[method] ? active[method].call(this, othis) : '';
        });
    })

    layui.use('layer', function () { //独立版的layer无需执行这一句
        var $ = layui.jquery, layer = layui.layer; //独立版的layer无需执行这一句

        //触发事件
        var active = {
            end: function () {
                var that = this;
                layer.open({
                    type: 1 //此处以iframe举例
                    , title: '提示'
                    , area: ['350px', '134px']
                    , shade: 0.3
                    , maxmin: true
                    , id: "_add"
                    , content: "<div id='form8'></div>"
                });
                layui.laytpl($("#tips1").html()).render({}, function (html) {
                    $("#form8").html(html);
                    layui.form.render();
                })

            },
            delete: function () {
                var that = this;
                layer.open({
                    type: 1 //此处以iframe举例
                    , title: '提示'
                    , area: ['350px', '134px']
                    , shade: 0.3
                    , maxmin: true
                    , id: "_add"
                    , content: "<div id='form9'></div>"
                });
                layui.laytpl($("#tips2").html()).render({}, function (html) {
                    $("#form9").html(html);
                    layui.form.render();
                })

            },
            trusted: function () {
                var that = this;
                layer.open({
                    type: 1 //此处以iframe举例
                    , title: '委托'
                    , area: ['600px', '398px']
                    , shade: 0.3
                    , maxmin: true
                    , id: "_add"
                    , content: "<div id='form7'></div>"
                });
                layui.laytpl($("#trusted").html()).render({}, function (html) {
                    $("#form7").html(html);
                    layui.form.render();
                })

            },
            interpose: function () {
                layer.open({
                    type: 1 //此处以iframe举例
                    , title: '流程干预'
                    , area: ['400px', '348px']
                    , id: '_interpose'
                    , shade: 0.3
                    , maxmin: true
                    , content: "<div id='form6'></div>"

                });
                layui.laytpl($("#interpose").html()).render({}, function (html) {
                    $("#form6").html(html);
                    layui.form.render();
                })
            },
            destroy: function () {
                layer.open({
                    type: 1 //此处以iframe举例
                    , title: '工作销毁'
                    , area: ['1400px', '448px']
                    , shade: 0.3
                    , id: "_destroy"
                    , maxmin: true
                    , content: "<div id='form5'></div>"

                });
                layui.laytpl($("#destroy").html()).render({}, function (html) {
                    $("#form5").html(html);
                    layui.form.render();
                })
                layui.use('table', function () {
                    var table = layui.table;

                    table.render({
                        elem: '#demo5'
                        , data: [
                            {
                                number: 35,
                                name: "差旅费用报销(2019-04-11 21:30:38)",
                                time: "2019-04-11 21:30:38",
                                belongs: "	差旅费用报销",
                                person: "系统管理员",
                                file: ""
                            }
                        ]
                        , cols: [[
                            {type: 'checkbox'}
                            , {field: 'number', width: 80, title: '流水号'}
                            , {field: 'name', minWidth: 180, title: '工作名称', templet: "#name2"}
                            , {field: 'belongs', width: 160, title: '所属流程'}
                            , {field: 'person', width: 100, title: '发起人'}
                            , {field: 'time', width: 170, title: '开始时间'}
                            , {field: 'file', width: 200, title: '公共附件'}
                            , {field: 'operations', width: 150, title: '操作', templet: "#operation2"}

                        ]]
                        , page: true
                    });
                });
            },
            selectStream: function () {
                var that = this;
                //多窗口模式，层叠置顶
                layer.open({
                    type: 1 //此处以iframe举例
                    , title: '选择流程'
                    , area: ['400px', '348px']
                    , shade: 0.3,
                    id: "_trust11"
                    , maxmin: true
                    , content: "<div id='form22'></div>"

                });
                layui.laytpl($("#trust1").html()).render({}, function (html) {
                    $("#form22").html(html);
                    layui.form.render();
                })
            },
            observe: function () {
                var that = this;
                //多窗口模式，层叠置顶
                layer.open({
                    type: 1 //此处以iframe举例
                    , title: '工作监控'
                    , area: ['1402px', '652px']
                    , shade: 0.3
                    , id: "_observe"
                    , maxmin: true
                    , content: "<div id='form3'></div>"
                });
                layui.laytpl($("#observe").html()).render({}, function (html) {
                    $("#form3").html(html);
                    layui.form.render();
                })
                layui.use('table', function () {
                    var table = layui.table;

                    table.render({
                        elem: '#demo3'
                        , data: [
                            {
                                number: 4,
                                person: "系统管理员",
                                time: "总用时：128天12小时24分钟10秒",
                                state: '0',
                                name: "员工外出申请（业务）(2019-03-03 01:50:51)",
                                belongs: "员工外出申请（业务）",
                                step: "第1步：外出申请",
                                file: "",
                                context: ""
                            },
                            {
                                number: 8,
                                person: "系统管理员",
                                time: "总用时：123天5小时36分钟2秒",
                                state: '0',
                                name: "员工外出申请（业务）(2019-03-08 08:39:00)",
                                belongs: "员工外出申请（业务）",
                                step: "第1步：外出申请",
                                file: "",
                                context: ""
                            },
                            {
                                number: 41,
                                person: "系统管理员",
                                time: "总用时：61天1小时23分钟28秒",
                                state: '0',
                                name: "员工外出申请（业务）(2019-05-09 12:51:36)",
                                belongs: "员工外出申请（业务）",
                                step: "第1步：外出申请",
                                file: "",
                                context: ""
                            },
                            {
                                number: 73,
                                person: "xsy",
                                time: "总用时：3天23小时32分钟1秒",
                                state: '0',
                                name: "员工外出申请（业务）(2019-05-09 14:43:01)",
                                belongs: "员工外出申请（业务）",
                                step: "第1步：外出申请",
                                file: "",
                                context: ""
                            }
                        ]
                        , cols: [[
                            {type: 'checkbox'}
                            , {field: 'number', width: 80, title: '流水号'}
                            , {field: 'name', minWidth: 280, title: '工作名称', templet: "#name1"}
                            , {field: 'belongs', width: 160, title: '所属流程', templet: "#belong"}
                            , {field: 'person', width: 100, title: '流程发起人'}
                            , {field: 'person', width: 100, title: '当前办理人'}
                            , {field: 'step', title: '当前步骤', width: 160, templet: "#step"}
                            , {field: 'time', width: 170, title: '办理时间'}
                            , {field: 'operations', width: 250, title: '操作', templet: "#operation1"}
                        ]]
                        , page: true
                    });
                });
            },
            move: function () {
                var that = this;
                //多窗口模式，层叠置顶
                layer.open({
                    type: 1 //此处以iframe举例
                    , title: '工作移交'
                    , area: ['502px', '452px']
                    , shade: 0.3
                    , id: "_move"
                    , maxmin: true
                    , content: "<div id='form'></div>"

                });
                layui.laytpl($("#move").html()).render({}, function (html) {
                    $("#form").html(html);
                    layui.form.render();
                })
                layui.use('laydate', function () {
                    var laydate = layui.laydate;

                    //常规用法
                    laydate.render({
                        elem: '#test21'
                    });

                    //国际版
                    laydate.render({
                        elem: '#test22'
                    });


                });
            },
            trust: function () {
                var that = this;
                //多窗口模式，层叠置顶
                layer.open({
                    type: 1 //此处以iframe举例
                    , title: '工作委托'
                    , area: ['652px', '452px']
                    , shade: 0.3,
                    id: "_trust"
                    , maxmin: true
                    , content: "<div id='form2'></div>"

                });
                layui.laytpl($("#trust").html()).render({}, function (html) {
                    $("#form2").html(html);
                    layui.form.render();
                })
                layui.use('laydate', function () {
                    var laydate = layui.laydate;

                    //常规用法
                    laydate.render({
                        elem: '#test33'
                    });

                    //国际版
                    laydate.render({
                        elem: '#test34'
                    });
                });
                layui.use('element', function () {
                    var $ = layui.jquery
                        , element = layui.element; //Tab的切换功能，切换事件监听等，需要依赖element模
                    $("li").on('click', function (e) {
                        var others = $(this).siblings();
                        if ($(this).hasClass('unselect')) {
                            $(this).removeClass('unselect');
                            $(this).addClass('select');
                            others.addClass('unselect');
                            $('#createView').hide();
                        }
                    })
                })
                layui.use('table', function () {
                    var table = layui.table;

                    //第一个实例
                    table.render({
                        elem: '#demo'
                        , data: []
                        , page: true //开启分页
                        , cols: [[ //表头
                            {field: 'state', title: '状态', width: 80}
                            , {field: 'name', title: '流程名称', width: 150}
                            , {field: 'step', title: '委托人', width: 90}
                            , {field: 'truster', title: '被委托人', width: 100}
                            , {field: 'time', title: '有效期', width: 80}
                            , {field: 'operations', title: '操作', width: 80}
                        ]]
                    });
                    table.render({
                        elem: '#demo1'
                        , data: [
                            {
                                number: 66,
                                name: "合同审批申请（演示）(2019-06-24 14:54:25)",
                                step: "法务部门意见",
                                state: '0',
                                truster: "王敏芳",
                                time: "2019-06-24 03:00"
                            },
                            {
                                number: 66,
                                name: "合同审批申请（演示）(2019-06-24 13:17:55)",
                                step: "法务部门意见",
                                state: '0',
                                truster: "王敏芳",
                                time: "2019-07-08 08:38"
                            }
                        ]
                        , width: 620
                        , page: true //开启分页
                        , cols: [[ //表头
                            {field: 'number', title: '流水号', width: 80}
                            , {field: 'name', title: '工作名称/文号', width: 150, templet: "#name1"}
                            , {field: 'step', title: '步骤名称', width: 100}
                            , {field: 'state', title: '当前状态', width: 100, templet: "#state1"}
                            , {field: 'truster', title: '被委托人', width: 100}
                            , {field: 'time', title: '委托时间', width: 100}
                        ]]
                    });
                    table.render({
                        elem: '#demo2'
                        , data: []
                        , width: 620
                        , page: true //开启分页
                        , cols: [[ //表头
                            {field: 'number', title: '流水号', width: 80}
                            , {field: 'name', title: '工作名称/文号', width: 150, templet: "#name1"}
                            , {field: 'step', title: '步骤名称', width: 100}
                            , {field: 'state', title: '当前状态', width: 100, templet: "#state1"}
                            , {field: 'truster', title: '被委托人', width: 100}
                            , {field: 'time', title: '委托时间', width: 100}
                        ]]
                    });
                });

            },
            add: function () {
                var that = this;
                layer.open({
                    type: 1 //此处以iframe举例
                    , title: '选择人员'
                    , area: ['565px', '460px']
                    , shade: 0.3
                    , maxmin: true
                    , id: "_add"
                    , content: "<div id='form1'></div>"

                });
                layui.laytpl($("#add").html()).render({}, function (html) {
                    $("#form1").html(html);
                    layui.form.render();
                })
                $("li").on('click', function (e) {
                    var others = $(this).siblings();

                    if ($(this).hasClass('unselect')) {

                        $(this).removeClass('unselect');
                        $(this).addClass('select');
                        others.addClass('unselect');
                        $('#createView').hide();
                    }
                })

                layui.use(['element', 'layer'], function () {
                    var element = layui.element;
                    var layer = layui.layer;
                    element.render('collapse');
                });
            }
        };

        $('.layui-btn').on('click', function () {
            var othis = $(this), method = othis.data('method');
            active[method] ? active[method].call(this, othis) : '';
        });
        $(document).on('click', '.layui-icon', function () {
            var othis = $(this), method = othis.data('method');
            active[method] ? active[method].call(this, othis) : '';
        });
        $(document).on('click', '.layui-btn', function () {
            var othis = $(this), method = othis.data('method');
            active[method] ? active[method].call(this, othis) : '';
        });
        $(document).on('focus', '.layui-input', function () {
            var othis = $(this), method = othis.data('method');
            active[method] ? active[method].call(this, othis) : '';
        });
    });


    layui.use('element', function () {
        var $ = layui.jquery
            , element = layui.element; //Tab的切换功能，切换事件监听等，需要依赖element模
        $("li").on('click', function (e) {
            var others = $(this).siblings();
            if ($(this).hasClass('unselect')) {

                $(this).removeClass('unselect');
                $(this).addClass('select');
                others.addClass('unselect');
                $('#createView').hide();
            }
        })
        $('.options_files li').mouseover(function () {
            $(this).css("background", '#1E9FFF');
            $(this).css("color", '#FFF');
        })
        $('.options_files li').mouseout(function () {
            $(this).css("background", '#fff');
            $(this).css("color", '#000');
        })
    });
    layui.use(['form', 'layedit', 'laydate'], function () {
        var form = layui.form
            , layer = layui.layer
            , layedit = layui.layedit
            , laydate = layui.laydate;

        //日期
        laydate.render({
            elem: '#date'
        });
        laydate.render({
            elem: '#date1'
        });
    });
</script>
<script type="text/html" id='select1'>
    <div class='box' style='height:230px;'>
        <ul id="treeDemo" class="ztree" style="width: 390px;height: 220px;"></ul>
    </div>
    <div class='layui-btn-container' style='position:absolute;bottom:10px;right:20px;'>
        <button class='layui-btn '>确定</button>
        <button class='layui-btn layui-btn-primary close' onclick='layer.closeAll();'>关闭</button>
    </div>
</script>
<script type='text/html' id='tips1'>
    <div style='text-align:center;line-height:50px;'>确认要结束此工作吗？</div>
    <div class='layui-btn-container' style='position:absolute;bottom:5px;right:20px;'>
        <button class='layui-btn layui-btn-primary layui-btn-sm close' onclick='layer.closeAll();'>取消</button>
        <button class='layui-btn  layui-btn-sm'>确定</button>
    </div>
</script>
<script type='text/html' id='tips2'>
    <div style='text-align:center;line-height:50px;'>确认要删除此工作吗？</div>
    <div class='layui-btn-container' style='position:absolute;bottom:5px;right:20px;'>
        <button class='layui-btn layui-btn-primary layui-btn-sm close' onclick='layer.closeAll();'>取消</button>
        <button class='layui-btn  layui-btn-sm'>确定</button>
    </div>
</script>
<script type="text/html" id='trusted'>
    <form class='layui-form'>
        <div class='layui-form-item'>
            <label class='layui-form-label' style='width:110px;text-align:right;'>流水号：</label>
            <div class='layui-input-block' style='line-height:36px;'>4</div>
        </div>
        <div class='layui-form-item'>
            <label class='layui-form-label' style='width:110px;text-align:right;'>工作名称/文号：</label>
            <div class='layui-input-block' style='line-height:36px;'>员工外出申请（业务）(2019-03-03 01:50:51)</div>
        </div>
        <div class='layui-form-item'>
            <label class='layui-form-label' style='width:110px;text-align:right;'>当前步骤：</label>
            <div class='layui-input-block' style='line-height:36px;'> 外出申请</div>
        </div>
        <div class='layui-form-item'>
            <label class='layui-form-label' style='width:110px;text-align:right;'>委托给：</label>
            <div class='layui-input-block' style='line-height:36px;'>
                <input type="text" class='layui-input' readOnly style='width:330px;display:inline-block'>
                <i class='layui-icon layui-icon-add-1' style='color:#379ff7' data-method="add"></i>
            </div>
        </div>
    </form>
    <div class='layui-btn-container' style='position:absolute;bottom:10px;right:20px;'>
        <button class='layui-btn '>确定</button>
        <button class='layui-btn layui-btn-primary close' onclick='layer.closeAll();'>关闭</button>
    </div>
</script>
<script type="text/html" id="stateTpl">
    {{#  if(d.state == 0){ }}
    <span style='color:green'>进行中</span>
    {{#  } else{ }}
    <span style='color:red;'>已结束</span>
    {{#  } }}
</script>

<script type="text/html" id='destroy'>
    <form class='layui-form' style='margin-top:20px;display:inline-block'>
        <div class='layui-form-item'>
            <div class='layui-input-block' style='width:200px;margin-left:30px'>
                <input type="text" class='layui-input' placeholder='请输入工作名称/流水号'>
            </div>
        </div>
    </form>
    <div class='layui-btn-container' style='display:inline-block;margin-left:50px;'>
        <button class='layui-btn '>查询</button>
        <button class='layui-btn '>高级检索</button>
        <button class='layui-btn layui-btn-danger'>批量删除</button>
    </div>
    <table id="demo5" lay-filter="test"></table>
</script>
<script type='text/html' id='select'>
    <div class="layui-collapse" lay-accordion="">
        <div class="layui-colla-item">
            <h2 class="layui-colla-title" style='border:0;background:#fff'>全部流程</h2>
        </div>
        <div class="layui-colla-item">
            <h2 class="layui-colla-title" style='border:0;background:#fff'>人事类</h2>
            <div class="layui-colla-content">
                <p>员工外出申请（业务）</p>
            </div>
        </div>
    </div>
    <div class='layui-btn-container' style='position:absolute;bottom:10px;right:20px;'>
        <button class='layui-btn '>确定</button>
        <button class='layui-btn layui-btn-primary' onclick='layer.closeAll();'>关闭</button>
    </div>
</script>
<script type="text/html" id="state1">
    {{#  if(d.state === "0"){ }}
    <span>未接收</span>
    {{#  } else{ }}
    <span>已接收</span>
    {{#  } }}
</script>
<script type='text/html' id='observe'>
    <form class='layui-form' style='margin-top:10px'>
        <div class='layui-form-item' style='display:inline-block;'>
            <label class='layui-form-label'>流水号:</label>
            <div class='layui-input-block'>
                <input type="text" class='layui-input' style='width:150px'>
            </div>
        </div>
        <div class='layui-form-item' style='display:inline-block;'>
            <label class='layui-form-label'>流程标题:</label>
            <div class='layui-input-block'>
                <input type="text" class='layui-input' style='width:150px'>
            </div>
        </div>
    </form>
    <form class='layui-form'>
        <div class='layui-form-item' style='display:inline-block;'>
            <label class='layui-form-label'>流程选择:</label>
            <div class='layui-input-block' style='width:300px;'>
                <!-- <input type="text" class='layui-input' style='width:150px' data-method='selectStream' readOnly>  -->
                <select id="flowIds" class="BigSelect" multiple=""
                        style="width:300px;height:200px;text-align:left;font-family:Microsoft YaHei;font-size: 12px; ">
                    <optgroup label="默认分类">
                        <option value="37">自由流程测试</option>
                        <option value="89">签章测试流程</option>
                        <option value="90">测试111</option>
                    </optgroup>
                    <optgroup label="人事类">
                        <option value="1">员工外出申请（业务）</option>
                        <option value="50">员工请假申请（业务）</option>
                        <option value="51">员工出差申请（业务）</option>
                        <option value="52">员工加班申请（业务）</option>
                    </optgroup>
                    <optgroup label="行政类">
                        <option value="9">办公用品出库（业务）</option>
                        <option value="55">公司用印申请</option>
                        <option value="59">通知公告审批流程（业务）</option>
                        <option value="60">新闻发布审批流程（业务）</option>
                        <option value="87">资产购置申请（业务）</option>
                        <option value="88">资产调拨申请（业务）</option>
                        <option value="56">公司资质借用申请</option>
                        <option value="40">资产领用申请（业务）</option>
                        <option value="41">资产归还申请（业务）</option>
                        <option value="42">资产报废申请（业务）</option>
                        <option value="43">资产报修申请（业务）</option>
                    </optgroup>
                    <optgroup label="项目类">
                        <option value="53">立项申请流程</option>
                        <option value="54">立项审批流程</option>
                    </optgroup>
                    <optgroup label="费用类">
                        <option value="44">费用预算申请（业务）</option>
                        <option value="45">差旅费用报销</option>
                        <option value="61">部门年度费用计划申请（业务）</option>
                        <option value="62">个人年度费用计划申请（业务）</option>
                        <option value="33">借支单</option>
                        <option value="34">费用报销申请（业务）</option>
                        <option value="57">费用借款单</option>
                        <option value="58">常用费用报销单</option>
                    </optgroup>
                    <optgroup label="库存类">
                        <option value="48">货品入库（业务）</option>
                        <option value="49">货品出库（业务）</option>
                    </optgroup>
                    <optgroup label="公文类">
                        <option value="21">办公室发文</option>
                        <option value="39">办公室收文</option>
                    </optgroup>
                    <optgroup label="合同类">
                        <option value="30">合同审批申请（演示）</option>
                    </optgroup>
                </select>
            </div>
        </div>
        <div class='layui-form-item' style='display:inline-block;'>
            <label class='layui-form-label'>人员条件:</label>
            <div class='layui-input-block' style='width:120px;'>
                <select name="" id="">
                    <option value="0" selected>当前主办人</option>
                    <option value="1">流程发起人</option>
                </select>
            </div>
        </div>
        <div class='layui-form-item' style='display:inline-block;'>
            <div class='layui-input-block' style='width:180px;margin-left:10px;'>
                <input type="text" class='layui-input' style='width:120px;display:inline-block'>
                <i class='layui-icon layui-icon-add-1' style='color:#379ff7' data-method="add"></i>
                <i class='layui-icon layui-icon-close' style='color:#379ff7'></i>
            </div>
        </div>
        <button class='layui-btn ' style='display:inline-block'>查询</button>
        <table id="demo3" lay-filter="test"></table>
    </form>

</script>
<script id='interpose' type="text/html">
    <form class='layui-form' style='margin-top:10px;'>
        <div class='layui-form-item'>
            <label class='layui-form-label' style='width:100px;padding:9px 0'>跳转至节点：</label>
            <div class='layui-input-block' style='width:200px;'>
                <select name="" id="">
                    <option value="0" selected>外出申请</option>
                    <option value="1">部门经理审核</option>
                    <option value="2">总经理</option>
                    <option value="3">人事备档</option>
                </select>
            </div>
        </div>
        <div class='layui-form-item'>
            <label class='layui-form-label' style='width:100px;padding:9px 0'>节点办理人：</label>
            <div class='layui-input-block' style='width:200px;'>
                <input type="text" class='layui-input'>
            </div>
        </div>
    </form>
    <div class='layui-btn-container' style='position:absolute;bottom:10px;right:20px;'>
        <button class='layui-btn '>确定</button>
        <button class='layui-btn layui-btn-primary close' onclick='layer.closeAll();'>关闭</button>
    </div>
</script>
<script type="text/html" id="name1">
    <div>
        <a href="#" style='color:#126DBA'>{{d.name}}</a>
    </div>
</script>
<script type="text/html" id="name2">
    <div>
        <a href="#" style='color:#126DBA'>{{d.name}}</a>
    </div>
</script>
<script type="text/html" id="file">
    <span style='color:#126DBA' class='file'>{{d.file}}</span>
</script>
<script type="text/html" id="context">
    <span style='color:#126DBA'>{{d.context}}</span>
</script>
<script type="text/html" id="operation1">
    <div class='layui-btn-container'>
        <button class='layui-btn  layui-btn-sm' data-method='interpose'>干预</button>
        <button class='layui-btn  layui-btn-sm' data-method='trusted'>委托</button>
        <button class='layui-btn  layui-btn-sm' data-method='end'>结束</button>
        <button class='layui-btn  layui-btn-sm' data-method='delete'>删除</button>
    </div>
</script>
<script type="text/html" id="operation2">
    <div class='layui-btn-container'>
        <button class='layui-btn  layui-btn-sm'>销毁</button>
        <button class='layui-btn  layui-btn-sm'>还原</button>
    </div>
</script>
<script type="text/html" id='move'>
    <div class='layui-card'>
        <div class='layui-card-body' style='height:380px;'>
            <form class='layui-form'>
                <div class="layui-form-item">
                    <label class="layui-form-label" style='padding:9px 0;width:70px;'><span style='color:red'>*</span>选择流程</label>
                    <div class="layui-input-block" style='margin-left:90px;'>
                        <select id="flowIds" class="BigSelect" multiple=""
                                style="width:300px;height:200px;text-align:left;font-family:Microsoft YaHei;font-size: 12px; ">
                            <optgroup label="默认分类">
                                <option value="37">自由流程测试</option>
                                <option value="89">签章测试流程</option>
                                <option value="90">测试111</option>
                            </optgroup>
                            <optgroup label="人事类">
                                <option value="1">员工外出申请（业务）</option>
                                <option value="50">员工请假申请（业务）</option>
                                <option value="51">员工出差申请（业务）</option>
                                <option value="52">员工加班申请（业务）</option>
                            </optgroup>
                            <optgroup label="行政类">
                                <option value="9">办公用品出库（业务）</option>
                                <option value="55">公司用印申请</option>
                                <option value="59">通知公告审批流程（业务）</option>
                                <option value="60">新闻发布审批流程（业务）</option>
                                <option value="87">资产购置申请（业务）</option>
                                <option value="88">资产调拨申请（业务）</option>
                                <option value="56">公司资质借用申请</option>
                                <option value="40">资产领用申请（业务）</option>
                                <option value="41">资产归还申请（业务）</option>
                                <option value="42">资产报废申请（业务）</option>
                                <option value="43">资产报修申请（业务）</option>
                            </optgroup>
                            <optgroup label="项目类">
                                <option value="53">立项申请流程</option>
                                <option value="54">立项审批流程</option>
                            </optgroup>
                            <optgroup label="费用类">
                                <option value="44">费用预算申请（业务）</option>
                                <option value="45">差旅费用报销</option>
                                <option value="61">部门年度费用计划申请（业务）</option>
                                <option value="62">个人年度费用计划申请（业务）</option>
                                <option value="33">借支单</option>
                                <option value="34">费用报销申请（业务）</option>
                                <option value="57">费用借款单</option>
                                <option value="58">常用费用报销单</option>
                            </optgroup>
                            <optgroup label="库存类">
                                <option value="48">货品入库（业务）</option>
                                <option value="49">货品出库（业务）</option>
                            </optgroup>
                            <optgroup label="公文类">
                                <option value="21">办公室发文</option>
                                <option value="39">办公室收文</option>
                            </optgroup>
                            <optgroup label="合同类">
                                <option value="30">合同审批申请（演示）</option>
                            </optgroup>
                        </select>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label" style='padding:9px 0;width:70px;'><span style='color:red'>*</span>原办理人</label>
                    <div class="layui-input-block" style='margin-left:90px;'>
                        <input type="text" class='layui-input' readOnly style='width:330px;display:inline-block'>
                        <i class='layui-icon layui-icon-add-1' style='color:#379ff7' data-method="add"></i>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label" style='padding:9px 0;width:70px;'><span style='color:red'>*</span>移交对象</label>
                    <div class="layui-input-block" style='margin-left:90px;'>
                        <input type="text" class='layui-input' readOnly style='width:330px;display:inline-block'>
                        <i class='layui-icon layui-icon-add-1' style='color:#379ff7' data-method="add"></i>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label" style='padding:9px 0;width:70px;'>时间范围</label>
                    <div class="layui-input-block" style='margin-left:90px;'>
                        <input type="text" class="layui-input" id="test21" placeholder="yyyy-MM-dd"
                               style='display:inline-block;margin-right:15px;width:160px' readOnly>至<input type="text"
                                                                                                           class='layui-input '
                                                                                                           readOnly
                                                                                                           style='width:160px;display:inline-block;margin-left:15px;'
                                                                                                           id='test22'
                                                                                                           placeholder="yyyy-MM-dd">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label" style='padding:9px 0;width:70px;'>流水号范围</label>
                    <div class="layui-input-block" style='margin-left:90px;'>
                        <input type="text" class='layui-input'
                               style='width:160px;display:inline-block;margin-right:15px;'>至<input type="text"
                                                                                                   class='layui-input'
                                                                                                   style='width:160px;display:inline-block;margin-left:15px;'>
                    </div>
                </div>
            </form>
            <button class='layui-btn ' style='margin:10px 0px 0 370px'>确认提交</button>
        </div>
    </div>
</script>
<script type="text/html" id='trust'>
    <div class='layui-card'>
        <div class='layui-card-body' style='height:380px;'>
            <div class="layui-tab" id='select'>
                <ul class="layui-tab-title" style='border:0;margin-bottom:10px;'>
                    <li class="layui-this select">设定规则</li>
                    <li class="unselect">规则查询</li>
                    <li class="unselect">已委托记录</li>
                    <li class="unselect">被委托记录</li>
                </ul>
                <div class="layui-tab-content">
                    <div class="layui-tab-item layui-show">
                        <form class='layui-form' style='margin-top:20px;'>
                            <div class="layui-form-item">
                                <label class="layui-form-label" style='padding:9px 0;width:70px;'>委托人:</label>
                                <div class="layui-input-block" style='margin-left:90px;'>
                                    <input type="text" class='layui-input' readOnly
                                           style='width:300px;display:inline-block'>
                                    <i class='layui-icon layui-icon-add-1' style='color:#379ff7' data-method="add"></i>
                                    <i class='layui-icon layui-icon-close' style='color:#379ff7'></i>
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label" style='padding:9px 0;width:70px;'>被委托人:</label>
                                <div class="layui-input-block" style='margin-left:90px;'>
                                    <input type="text" class='layui-input' readOnly
                                           style='width:300px;display:inline-block'>
                                    <i class='layui-icon layui-icon-add-1' style='color:#379ff7' data-method="add"></i>
                                    <i class='layui-icon layui-icon-close' style='color:#379ff7'></i>
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label" style='padding:9px 0;width:70px;'>选择流程:</label>
                                <div class="layui-input-block" style='margin-left:90px; width:300px'>
                                    <!-- <input type="text" class='layui-input' style='width:300px;' data-method='selectStream' readOnly> -->
                                    <select id="flowIds" class="BigSelect" multiple=""
                                            style="width:300px;height:200px;text-align:left;font-family:Microsoft YaHei;font-size: 12px; ">
                                        <optgroup label="默认分类">
                                            <option value="37">自由流程测试</option>
                                            <option value="89">签章测试流程</option>
                                            <option value="90">测试111</option>
                                        </optgroup>
                                        <optgroup label="人事类">
                                            <option value="1">员工外出申请（业务）</option>
                                            <option value="50">员工请假申请（业务）</option>
                                            <option value="51">员工出差申请（业务）</option>
                                            <option value="52">员工加班申请（业务）</option>
                                        </optgroup>
                                        <optgroup label="行政类">
                                            <option value="9">办公用品出库（业务）</option>
                                            <option value="55">公司用印申请</option>
                                            <option value="59">通知公告审批流程（业务）</option>
                                            <option value="60">新闻发布审批流程（业务）</option>
                                            <option value="87">资产购置申请（业务）</option>
                                            <option value="88">资产调拨申请（业务）</option>
                                            <option value="56">公司资质借用申请</option>
                                            <option value="40">资产领用申请（业务）</option>
                                            <option value="41">资产归还申请（业务）</option>
                                            <option value="42">资产报废申请（业务）</option>
                                            <option value="43">资产报修申请（业务）</option>
                                        </optgroup>
                                        <optgroup label="项目类">
                                            <option value="53">立项申请流程</option>
                                            <option value="54">立项审批流程</option>
                                        </optgroup>
                                        <optgroup label="费用类">
                                            <option value="44">费用预算申请（业务）</option>
                                            <option value="45">差旅费用报销</option>
                                            <option value="61">部门年度费用计划申请（业务）</option>
                                            <option value="62">个人年度费用计划申请（业务）</option>
                                            <option value="33">借支单</option>
                                            <option value="34">费用报销申请（业务）</option>
                                            <option value="57">费用借款单</option>
                                            <option value="58">常用费用报销单</option>
                                        </optgroup>
                                        <optgroup label="库存类">
                                            <option value="48">货品入库（业务）</option>
                                            <option value="49">货品出库（业务）</option>
                                        </optgroup>
                                        <optgroup label="公文类">
                                            <option value="21">办公室发文</option>
                                            <option value="39">办公室收文</option>
                                        </optgroup>
                                        <optgroup label="合同类">
                                            <option value="30">合同审批申请（演示）</option>
                                        </optgroup>
                                    </select>
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label" style='padding:9px 0;width:70px;'>生效时间</label>
                                <div class="layui-input-block" style='margin-left:90px;' id='check'>
                                    <input type="text" class="layui-input" id="test33" placeholder="yyyy-MM-dd"
                                           style='display:inline-block;margin-right:15px;width:100px'
                                           readOnly>终止时间<input type="text" class='layui-input ' readOnly
                                                               style='width:100px;display:inline-block;margin-left:15px;'
                                                               id='test34' placeholder="yyyy-MM-dd">
                                    <input type="checkbox" lay-skin='primary'>一直有效
                                </div>
                            </div>
                        </form>
                        <div class='layui-btn-container' style='position:absolute;right:10px;bottom:5px;'>
                            <button class='layui-btn  layui-btn-sm'>保存</button>
                            <button class='layui-btn  layui-btn-sm'>重置</button>
                        </div>
                    </div>
                    <div class="layui-tab-item">
                        <form class='layui-form' style='display:inline-block'>
                            <div class='layui-form-item'>
                                <label class='layui-form-label' style='padding:9px 0'>按人员查询</label>
                                <div class="layui-input-block" style='margin-left:90px;'>
                                    <input type="text" class='layui-input' readOnly
                                           style='width:100px;display:inline-block'>
                                    <i class='layui-icon layui-icon-add-1' style='color:#379ff7' data-method="add"></i>
                                    <i class='layui-icon layui-icon-close' style='color:#379ff7'></i>
                                </div>
                            </div>
                        </form>
                        <div class='layui-btn-container' style='display:inline-block;margin-left:10px;'>
                            <button class='layui-btn '>查询</button>
                            <button class='layui-btn layui-btn-danger' style='margin-left:150px;'>全部删除</button>
                        </div>
                        <table id="demo" lay-filter="test"></table>
                    </div>
                    <div class="layui-tab-item">
                        <form class='layui-form' style='display:inline-block'>
                            <div class='layui-form-item'>
                                <label class='layui-form-label' style='width:100px;padding:9px 0'>工作名称/文号:</label>
                                <div class='layui-input-block'>
                                    <input type="text" class='layui-input' style='width:130px'>
                                </div>
                            </div>
                        </form>
                        <button class='layui-btn ' style='display:inline-block;margin-left:20px'>查询</button>
                        <table id="demo1" lay-filter="test"></table>
                    </div>
                    <div class="layui-tab-item">
                        <form class='layui-form' style='display:inline-block'>
                            <div class='layui-form-item'>
                                <label class='layui-form-label' style='width:100px;padding:9px 0'>工作名称/文号:</label>
                                <div class='layui-input-block'>
                                    <input type="text" class='layui-input' style='width:130px'>
                                </div>
                            </div>
                        </form>
                        <button class='layui-btn ' style='display:inline-block;margin-left:20px'>查询</button>
                        <table id="demo2" lay-filter="test"></table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</script>
<script id="add" type="text/html">
    <div class='layui-fluid'>
        <div class='layui-row layui-col-space10'>
            <div class='layui-col-md7' style='height:390px;margin-left:15px;width:300px;margin-right:10px'>
                <div class='layui-card'>
                    <div class='layui-card-body'>
                        <div class="layui-tab" id='select'>
                            <ul class="layui-tab-title" style='border:0;'>
                                <li class="layui-this select">按部门选择</li>
                                <li class="unselect">按角色选择</li>
                                <li class="unselect">自定义组</li>
                            </ul>
                            <div class="layui-tab-content"
                                 style='border:1px solid #ccc;height:260px;overflow-Y:auto;padding:0;'>
                                <div class="layui-tab-item layui-show">
                                    <div class="layui-collapse" lay-accordion="" style="margin-left:0">
                                        <div class="layui-colla-item">
                                            <h2 class="layui-colla-title" style="background:#fff"><span
                                                    onclick='change(event)'>系统管理部</span></h2>
                                        </div>
                                        <div class="layui-colla-item">
                                            <h2 class="layui-colla-title" style='background:#fff'>
                                                <span onclick='change(event)'>信息部</span></h2>
                                            <div class="layui-colla-content" onclick='change(event)'
                                                 style='padding-left:50px;'>
                                                <p>信息一部</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-tab-item">
                                    <ul class='role' onclick='change(event)'>
                                        <li>系统管理员</li>
                                        <li>董事长</li>
                                        <li>总裁</li>
                                        <li>总经理</li>
                                        <li>分公司副总经理</li>
                                        <li>营销副总</li>
                                        <li>行政副总</li>
                                        <li>总经理助理</li>
                                        <li>人事经理</li>
                                        <li>行政经理</li>
                                        <li>采购经理</li>
                                        <li>财务经理</li>
                                        <li>研发经理</li>
                                        <li>员工</li>
                                    </ul>
                                </div>
                                <div class="layui-tab-item">没有设置自定义组</div>
                            </div>
                        </div>
                        <div id='bottom'
                             style='width:260px;height:35px; margin-top:5px;border:1px solid #ccc;line-height:35px'>
                            <i class='layui-icon layui-icon-username' style='margin-left:10px;'></i>&nbsp;&nbsp;已选人员
                        </div>
                    </div>
                </div>
            </div>
            <div class='layui-col-md5' style='height:380px;width:204px;'>
                <form class='layui-form'>
                    <div class='layui-form-item'>
                        <div class='layui-input-block' style='margin-left:0;width:100%'>
                            <input type="text" class='layui-input' style="display:inline-block;width:130px!important;"
                                   placeholder='按用户名搜索...'>
                            <button class='layui-btn' style='display:inline-block;position:absolute;top:0;right:0;'>
                                搜索
                            </button>
                        </div>
                    </div>
                </form>
                <div class='content' style='width:100%;height:275px;border:1px solid #ccc;margin-top:10px;'>
                    <div class='head' style='width:194px;height:40px;background:#f5f5f5;border-bottom:1px solid #ccc;'>
                        <form class='layui-form' style='width:165px;'>
                            <div class='layui-form-item' style='margin-bottom:0;'>
                                <div class='layui-input-block' style='margin-left:30px;width:30px;float:left'>
                                    <input type="checkbox" lay-skin='primary'>
                                </div>
                                <label class='layui-form-label'
                                       style='display:inline-block;padding:9px 0;text-align:left;width:100px;'
                                       id='head'>系统管理部</label>
                            </div>
                        </form>
                        <ul class='list'>
                            <li>系统管理员</li>
                            <li>123</li>
                        </ul>
                    </div>
                </div>
                <button class='layui-btn ' style="margin:10px 0 0 70px;">确定</button>
            </div>
        </div>
    </div>
</script>
<script type="text/html" id='trust1'>
    <div class='box' style='height:230px;overflow:auto;'>
        <ul id="treeDemo" class="ztree"></ul>
    </div>
    <div class='layui-btn-container' style='position:absolute;bottom:10px;right:20px;'>
        <button class='layui-btn ' id='confirm'>确定</button>
        <button class='layui-btn layui-btn-primary' onclick='layer.closeAll();'>关闭</button>
    </div>
    <script>
        function change(event) {
            var val = event.target.innerHTML;
            document.querySelector('#head').innerHTML = val;
        }
</script>
<script>
    layui.form.render();
</script>