<title>流程归档</title>
<style>
  #nav span,.right span{display: none;}
  #nav a{display: inline-block;width: 40px;height: 56px;text-align: center;border: 1px solid #f5f5f5;}
  #nav a:nth-of-type(3){display: inline-block;width: 220px;height: 52px; text-align: left;padding-left: 20px;border-top: 2px solid #000;font-weight: bold;}
  .right{display: inline-block;position: absolute;top: 0;right: 0;}
  .layui-breadcrumb a{color: #000!important;}
  .icon{background: url(./img/guidang.png) no-repeat; display: inline-block;width:22px;height: 22px;position: absolute;top:10px;}
</style>

<div class="layui-fluid">
  <div class="layui-card" style="height: 800px;">
    <div class="layui-card-header" style="border-bottom: 2px solid #379ff7;;">
      <span class="icon"></span>
      <span style="margin-left: 30px;">数据归档</span>
      <button class="layui-btn  layui-btn-sm" style="position: absolute;top:5px;right:15px;" data-method="combine">我要归档</button>
    </div>
    <div class="layui-card-body">
      <table class="layui-hide" id="test"></table>
    </div>
  </div>
</div>
<script>
  layui.use('table', function(){
    var table = layui.table;

    table.render({
      elem: '#test'
      ,data:[]
      ,cols: [[
        {field:'desc', width:"20%", title: '归档描述'}
        ,{field:'copyright', width:"20%", title: '归档数据版本'}
        ,{field:'time', width:"20%", title: '归档时间'}
        ,{field:'state', width:"20%", title: '归档状态'}
        ,{field:'operations', title: '操作', width:"20%"}
      ]]
      ,page: true
    });
  });
  layui.use('layer', function(){ //独立版的layer无需执行这一句
    var $ = layui.jquery, layer = layui.layer; //独立版的layer无需执行这一句

    //触发事件
    var active = {
      combine: function(){
        var that = this;
        //多窗口模式，层叠置顶
        layer.open({
          type: 1 //此处以iframe举例
          ,title: '流程归档'
          ,area: ['600px', '380px']
          ,shade: 0.3
          ,maxmin: false,
          content:"<div id='form1'></div>"
        });
        layui.laytpl($("#combine").html()).render({}, function(html){
          $("#form1").html(html);
          layui.form.render();
        })
        layui.use(['form', 'layedit', 'laydate'], function(){
          var form = layui.form
                  ,layer = layui.layer
                  ,layedit = layui.layedit
                  ,laydate = layui.laydate;

          //日期
          laydate.render({
            elem: '#test1'
          });



        });
      }


    };

    $(' .layui-btn').on('click', function(){
      var othis = $(this), method = othis.data('method');
      active[method] ? active[method].call(this, othis) : '';
    });

  });

</script>
<script type="text/html" id='combine'>
  <form class='layui-form' style='margin-top:20px;height:240px!important;overflow:auto;'>
    <div class='layui-form-item'>
      <label class='layui-form-label'>归档日期</label>
      <div class='layui-input-block'>
        <input type="text" class="layui-input" id="test1" style='display:inline-block;margin-right:15px;width:260px' value='2019-07-10'>
      </div>
    </div>
    <div class='layui-form-item'>
      <label class='layui-form-label'>归档日期</label>
      <div class='layui-input-block'>
        <textarea name="" id="" class='layui-textarea' style='width:350px;heght:120px;' value=''>2019-07-10之前工作流程的归档数据</textarea>
      </div>
    </div>
    <div class='layui-form-item'>
      <label class='layui-form-label' style='margin-top:100px;'>友好提示</label>
      <div class='layui-input-block'>
        <p style='color:red;line-height:25px'>(1)该操作具有一定危险性，非OA管理员严禁操作</p>
        <p style='color:red;line-height:25px'>(2)在做此操作之前，请您联系技术支持了解工作流数据归档的具体要求及注意事项</p>
        <p style='color:red;line-height:25px'>(3)在做此操作之前，请您做好数据库备份工作</p>
        <p style='color:red;line-height:25px'>(4)仅支持归档工作流程相关的数据，不支持级联归档关联工作流程的模块数据</p>
        <p style='color:red;line-height:25px'>（例如公文、用品、合同等）。归档后可能出现上述模块中无法查到已归档的流程数据</p>
      </div>
    </div>

  </form>
  <div class='layui-btn-container' style='position:absolute;bottom:10px;right:20px;'>
    <button class='layui-btn layui-btn-normal'>确定</button>
    <button class='layui-btn layui-btn-primary' onclick='layer.closeAll();'>关闭</button>
  </div>
</script>
<script>
  layui.form.render();
</script>