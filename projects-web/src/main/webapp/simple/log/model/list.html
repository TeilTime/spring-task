<title>组件操作日志</title>
<style>
  #nav span,.right span{display: none;}
  #nav a{display: inline-block;width: 40px;height: 56px;text-align: center;border: 1px solid #f5f5f5;}
  #nav a:nth-of-type(3){display: inline-block;width: 170px;height: 52px; text-align: left;padding-left: 20px;border-top: 2px solid #000;font-weight: bold;}
  .right{display: inline-block;position: absolute;top: 0;right: 0;}
  .layui-breadcrumb a{color: #000!important;}
  .layui-card .layui-table-view{margin: 60px 0 20px 0;}
</style>
<div class="layui-card layadmin-header">
  <div class="layui-breadcrumb" lay-filter="breadcrumb" id="nav">
    <a><i class="layui-icon layui-icon-prev"></i></a>
    <a lay-href=''><i class="layui-icon layui-icon-home"></i></a>
    <a>组件操作日志<i class="layui-icon layui-icon-close" style="margin-left: 50px"></i></a>
    <div class="right">
      <a><i class="layui-icon layui-icon-next"></i></a>
      <a><i class="layui-icon layui-icon-down"></i></a>
    </div>
  </div>
</div>
<div class="layui-fluid">
  <div class="layui-card" style="height: 760px;">
    <div class="layui-card-body">

      <form action="#" class="layui-form" style="float: right;margin-right:100px;">
        <div class="layui-form-item">
          <div class="layui-input-block">
            <input id="modelType" type="text" name="title" required  lay-verify="required" placeholder="组件类型" autocomplete="off" class="layui-input">
          </div>
        </div>
      </form>
      <button onclick="getModel(1,10)" class="layui-btn" style="display: inline-block;float:right;margin-right: -350px;"><i class="layui-icon">&#xe615;</i></button>
      <table class="layui-hide" id="test" style="margin-top: 100px;"></table>
      <div id="demo8"></div>

      <form class="layui-form" style="float: right;margin-right:100px;">
        <div class="layui-form-item">
          <div class="layui-input-block">
            <input type="text" name="title" required  lay-verify="required" placeholder="原始消息" autocomplete="off" class="layui-input">
          </div>
        </div>
      </form>
      <button class="layui-btn" style="display: inline-block;float:right;margin-right: -350px;"><i class="layui-icon">&#xe615;</i></button>
      <table class="layui-hide" id="test" style="margin-top: 100px;"></table>

    </div>
  </div>
</div>
<script>

    $(function () {
        getModel(1,10);
    })
    function getModel(pageNo,size) {
        var jsondata={
            "pager":{
                "current":pageNo,
                "size":size
            },
            "entity":{
                "modelType":document.getElementById("modelType").value
            }
        }
        $.ajax({
            type:"POST",
            url:"/log/model/list",
            contentType:"application/json",
            data:JSON.stringify(jsondata),
            dataType:"json",
            success:function (data) {
                console.log(data.obj)
                layui.use(['table','laypage'],function () {
                    var table=layui.table
                        ,laypage=layui.laypage;
                    table.render({
                        elem:'#test'
                        ,data:data.obj.records
                        ,cols: [[
                            {type:'numbers',title: '序号'}
                            ,{field:'column', width:220, title: '栏目'}
                            ,{field:'modelId', width:220, title: '组件ID'}
                            ,{field:'modelType', width:220, title: '组件类型'}
                            ,{field:'handleType', width:220, title: '操作类型'}
                            ,{field:'crUser', width:220, title: '用户名'}
                            ,{field:'detail', width:300, title: '操作明细'}
                            ,{field:'modifyTime', title: '操作时间', width:220}
                        ]]
                    })
                    laypage.render({
                        elem:'demo8'
                        ,count:data.obj.total
                        ,curr:data.obj.current
                        ,limit:data.obj.size
                        ,layout:['count','prev','page','next','limit','refresh','skip']
                        ,jump:function (obj,first) {
                            if (!first){
                                pageNo=obj.curr
                                size=obj.limit
                                getModel(pageNo,size)
                            }
                        }
                    })
                })
            },
            error:function (data) {
                layer.alert(data.msg)
            }
        })
    }

  // layui.use('table', function(){
  //   var table = layui.table;
  //
  //   table.render({
  //     elem: '#test'
  //     ,data:[
  //       {id:1,username:"admin",operation:"删除",contentType:"区块",chanel:"轮播图",crTime:"2019-03-07 10:59",content:"广告服务(485517)",detail:"小程序首页区块删除成功",componentid:337},
  //       {id:2,username:"admin",operation:"发布",contentType:"图片播放器",crTime:"2019-03-07 10:59",content:"广告服务(485517)",detail:"小程序首页播放器",componentid:165},
  //       {id:3,username:"admin",operation:"编辑",contentType:"图片播放器",crTime:"2019-03-07 10:24",content:"《天下第一镖局》定档8.24 樊少皇护镖第一美人(486159)",detail:"编辑小程序首页播放器",componentid:165},
  //       {id:4,username:"admin",operation:"编辑",contentType:"图片播放器",crTime:"2018-07-04 19:56",content:"零售业复苏迹象明显，周大福营收、溢利双增长(485995)",detail:"编辑小程序首页播放器",componentid:165},
  //       {id:5,username:"admin",operation:"删除",contentType:"区块",chanel:"轮播图",crTime:"2019-03-07 10:59",content:"广告服务(485517)",detail:"小程序首页区块删除成功",componentid:337},
  //       {id:6,username:"admin",operation:"发布",contentType:"图片播放器",crTime:"2019-03-07 10:59",content:"广告服务(485517)",detail:"小程序首页播放器",componentid:165},
  //       {id:7,username:"admin",operation:"编辑",contentType:"图片播放器",crTime:"2019-03-07 10:24",content:"《天下第一镖局》定档8.24 樊少皇护镖第一美人(486159)",detail:"编辑小程序首页播放器",componentid:165},
  //       {id:8,username:"admin",operation:"编辑",contentType:"图片播放器",crTime:"2018-07-04 19:56",content:"零售业复苏迹象明显，周大福营收、溢利双增长(485995)",detail:"编辑小程序首页播放器",componentid:165},
  //       {id:9,username:"admin",operation:"编辑",contentType:"图片播放器",crTime:"2019-03-07 10:24",content:"《天下第一镖局》定档8.24 樊少皇护镖第一美人(486159)",detail:"编辑小程序首页播放器",componentid:165},
  //       {id:10,username:"admin",operation:"编辑",contentType:"图片播放器",crTime:"2018-07-04 19:56",content:"零售业复苏迹象明显，周大福营收、溢利双增长(485995)",detail:"编辑小程序首页播放器",componentid:165}
  //     ]
  //     ,cols: [[
  //       {field:'id', width:80, title: '序号'}
  //       ,{field:'chanel', title: '栏目', width: 200}
  //       ,{field:'componentid', width:200, title: '组件id'}
  //       ,{field:'contentType',title:"组件类型",width:200}
  //       ,{field:'operation', width:160, title: '操作类型'}
  //       ,{field:'username', width:193, title: '用户名'}
  //       ,{field:'detail', title: '操作明细', width: 400}
  //       ,{field:'crTime', title: '操作时间', width:200}
  //     ]],
  //     page:true
  //   });
  // });

</script>